---
sidebar_position: 1
---

# convert.py

## Назначение

Основной модуль, выполняющий преобразование JSONL в HTML. Он управляет всем процессом: чтение файла, вызов модуля анализа, форматирование данных и запись итогового HTML-файла. Использует библиотеку `fire` для создания интерфейса командной строки. Определяет кастомное исключение `ExceptionFileInput` для обработки ошибок ввода.

## Основные компоненты

### Исключения

#### `ExceptionFileInput`
Кастомное исключение для обработки ошибок ввода файлов.

### Функции

#### `convert_jsonl_to_html()`

Основная функция конвертации JSONL файлов в HTML.

**Сигнатура:**
```python
def convert_jsonl_to_html(
    fn_input: str, 
    index_column: str = 'auto', 
    fn_output: str = "auto", 
    additional_table_content: dict = {}
) -> None
```

**Параметры:**
- `fn_input` (str): Путь к входному файлу `.jsonl`
- `index_column` (str): Название колонки для индексации. По умолчанию `'auto'`
- `fn_output` (str): Путь для сохранения выходного файла `.html`. По умолчанию `'auto'` (генерируется на основе имени входного файла)
- `additional_table_content` (dict): Дополнительные данные для вставки в таблицу

**Возвращает:**
- `None`

**Описание:**
Функция выполняет полный цикл преобразования:
1. Проверяет существование входного файла
2. Вызывает модуль анализа для генерации оглавления
3. Обрабатывает каждую строку JSONL
4. Создает самодостаточный HTML-файл

#### `main_bash_entry_point()`

Точка входа для консольного интерфейса, используемая библиотекой `fire`.

## Зависимости

### Внутренние модули
- `create_table_of_content` - для генерации оглавления и анализа

### Внешние библиотеки
- `fire` - создание CLI интерфейса
- `json` - работа с JSON данными
- `logging` - логирование процесса
- `pathlib` - работа с путями файлов
- `sys` - системные операции
- `base64` - кодирование данных
- `typing` - типизация

## Примеры использования

### Программный интерфейс

```python
from jsonl2html.convert import convert_jsonl_to_html

# Базовое использование
convert_jsonl_to_html("data.jsonl")

# С дополнительными параметрами
convert_jsonl_to_html(
    fn_input="data.jsonl",
    index_column="id",
    fn_output="report.html",
    additional_table_content={"source": "api_data"}
)
```

### Командная строка

```bash
# Базовая конвертация
python -m jsonl2html.convert data.jsonl

# С параметрами
python -m jsonl2html.convert data.jsonl --index_column=id --fn_output=report.html
```

## Архитектурные решения

1. **Использование Fire**: Автоматическое создание CLI интерфейса из Python функций
2. **Самодостаточный HTML**: Генерируемый файл не требует внешних зависимостей
3. **Модульная архитектура**: Разделение логики конвертации и анализа
4. **Обработка ошибок**: Кастомные исключения для четкой диагностики проблем
