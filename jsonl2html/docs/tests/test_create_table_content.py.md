# tests/test_create_table_content.py

## Назначение

Этот файл содержит модульные тесты для функций, расположенных в модуле `jsonl2html.create_table_of_content`. Тесты проверяют корректность генерации ссылок, сбора статистики по Unicode-символам и создания итогового оглавления на основе этой статистики.

## Основные компоненты

### Константы

*   `sample_dataframe`: `pandas.DataFrame`
    *   **Описание:** Глобальная переменная, содержащая тестовый DataFrame. Используется для проверки функций, работающих с данными в формате pandas. Включает колонки `rows`, `block` и `n_symbols`.

### Функции

*   `test_list_of_str_to_links(input_str, expected_output)`
    *   **Описание:** Тестирует функцию `list_of_str_to_links`. Использует параметризацию (`@pytest.mark.parametrize`) для проверки нескольких сценариев преобразования строки, содержащей список чисел, в строку с Markdown-ссылками.
*   `test_get_unicode_small_stats()`
    *   **Описание:** Тестирует функцию `get_unicode_small_stats`. Проверяет, что функция корректно генерирует строковую сводку статистики на основе `sample_dataframe`. Убеждается, что в результирующей строке присутствуют ключевые фразы "Bad Rows:" и "Bad Symbols:".
*   `test_create_table_of_content_unicode_stats()`
    *   **Описание:** Тестирует функцию `create_table_of_content_unicode_stats`. Является "дымовым" тестом (smoke test), который проверяет, что функция выполняется без ошибок при передаче ей пути к реальному файлу (`examples/small.jsonl`). Тест не проверяет содержимое сгенерированного вывода.

## Зависимости

*   `pytest`: Основной фреймворк для написания и запуска тестов. Используется для параметризации тестов (`@pytest.mark.parametrize`).
*   `pandas`: Используется для создания тестового DataFrame (`sample_dataframe`), который служит входными данными для тестируемых функций.
*   `unittest.mock`: Импортируются `patch` и `MagicMock`, но в представленном коде они не используются. Предназначены для мокирования (имитации) объектов и функций.
*   `json`: Используется для создания тестовых данных (преобразования списка Python в строку JSON) в тесте `test_list_of_str_to_links`.
*   `jsonl2html.create_table_of_content`: Модуль, содержащий тестируемые функции: `list_of_str_to_links`, `get_unicode_small_stats`, `create_table_of_content_unicode_stats`.

## Архитектурные решения

*   **Использование Pytest:** Тесты написаны с использованием фреймворка `pytest`, что позволяет применять его мощные возможности, такие как параметризация и автоматический поиск тестов.
*   **Параметризация тестов:** Тест `test_list_of_str_to_links` использует декоратор `@pytest.mark.parametrize` для проверки функции на нескольких наборах входных и ожидаемых данных. Это делает тест более полным и легко расширяемым.
*   **Разделение тестов:** Каждая тестируемая функция имеет свою собственную тестовую функцию, что соответствует принципу "один тест - одна проверка" и улучшает читаемость и поддерживаемость кода.
*   **Статические тестовые данные:** Для тестов используется предопределенный `pandas.DataFrame` (`sample_dataframe`), что обеспечивает воспроизводимость и предсказуемость результатов тестов.

## API/Интерфейсы

В данном файле определены только тестовые функции, которые не являются частью публичного API проекта. Они служат для внутренней проверки качества кода.

*   `test_list_of_str_to_links(input_str, expected_output)`
*   `test_get_unicode_small_stats()`
*   `test_create_table_of_content_unicode_stats()`

## Примеры использования

Файл сам по себе является примером использования фреймворка `pytest` для тестирования функций из модуля `jsonl2html.create_table_of_content`.

**Пример запуска тестов из командной строки (из корня проекта):**
```bash
pytest tests/test_create_table_content.py
```